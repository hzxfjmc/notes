# 网页安全

网页安全问题是一个在开发中应该极其注重的问题。

# Navigator

* [同源策略](#同源策略)

* [XSS](#XSS)

* [CSRF](#CSRF)

* [SQL注入](#SQL注入)

* [点击劫持](#点击劫持)

* [window.opener安全问题](#window.opener安全问题)

* [文件上传漏洞](#文件上传漏洞)


## 同源策略

同源策略是一个重要的安全策略，它用于限制一个origin的文档或者它加载的脚本如何能与另外一个源的资源进行交互。它能帮助阻隔恶意文档，减少可能被攻击的媒介。同源策略是浏览器为了安全而做出的一种安全策略

原理：如果两个URL的协议、域名、端口都一致的话那么他们就是同源，相反就是不同源会有跨域问题

### 同原协议的问题

* 同源策略限制了不同的JavaScript脚本对当前Dom对象的读写操作

* 同源策略限制了不同源的站点读取当前站点的Cookie、IndexDB、localStorage等重要数据。

* 同源策略限制了通过XMLHttpRequest等方式将站点的数据发送不同源的站点

### 解决同源策略的方法

* 跨文档消息机制：可以通过window.postMessage的JavaScript接口来和不同源的DOM进行通信

* 跨域资源共享（CORS）：跨域资源在服务器设置允许跨域，就可以进行跨域访问控制，从而使跨域数据传输得以安全进行

* 内容安全策略（CSP）:主要以白名单的形式配置可信任的内容来源，在网页中，能够使白名单中的内容正常执行（包括JS、CSS、image等等），而非白名单的内容无法正常执行

## XSS
XSS也叫跨脚本攻击，是最普遍的Web应用安全漏洞。共有两种攻击模式
### 存储型XSS攻击
利用漏洞提交恶意的JavaScript代码，比如在input、textarea等所有的可输入文本信息的区域，输入<script src="http://恶意网站"></script>等、提交活信息会存在服务器中，当用户打开网站请求到相应的数据，打开页面，恶意脚本就会将用户的Cookie信息上传到黑客服务器。

### 反射型XSS攻击
用户将一段含有恶意代码的请求提交给web服务器，web服务器接收请求时。又将恶意代码反射给浏览器。这就是反射型XSS攻击。我们经常遇到的黑客通过QQ群或者邮件等渠道去诱导用户点击这些恶意链接。

    这两种攻击方式的不同是。反射型攻击不会存储在服务上。存储型攻击会存储在服务器上

### 基于DOM的XSS攻击

基于DOM的XSS攻击不设计到服务器。它的特点是在Web资源传输过程中或者在用户使用页面过程中修改web页面的数据。比如数据劫持

### 预防策略

1、讲cookie等敏感信息设置为httponly。禁止JavaScript通过document.cookie获取

2、对所有的输入做严格的校验，尤其是服务器端。过滤掉任何不合法的输入，比如手机号码必须是数字。

3、净化和过滤掉不必要的html标签。比如img的img、script、iframe、等可输入型标签

4、转义单引号、双引号、尖括号等特殊字符，可以采用htmlencode编码或者过滤掉这些特殊字符。

5、CSP,CSP 全称为 Content Security Policy，即内容安全策略。主要以白名单的形式配置可信任的内容来源，在网页中，能够使白名单中的内容正常执行（包含 JS，CSS，Image 等等），而非白名单的内容无法正常执行，从而减少跨站脚本攻击（XSS），当然，也能够减少运营商劫持的内容注入攻击。 配置方式：

